{% extends "base.html" %}

{% block title %}Usuários{% endblock %}

{% block page_title %}Usuários{% endblock %}
{% block page_subtitle %}Gerencie usuários e permissões do sistema{% endblock %}

{% block content %}
<!-- Filtros e Controles -->
<div class="mb-6 flex flex-wrap gap-4 items-center">
  <button id="add-user-btn" class="px-4 py-2 rounded-lg transition" 
          style="background: var(--color-primary-500); color: white;">
    <i class="fas fa-plus mr-2"></i>Novo Usuário
  </button>

  <!-- Modal de Cadastro de Usuário -->
  <div id="user-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="rounded-lg shadow-lg p-8 w-full max-w-md relative" style="background: var(--card-bg);">
      <button id="close-user-modal" class="absolute top-2 right-2 transition" style="color: var(--text);">&times;</button>
      <h2 class="text-xl font-bold mb-4" style="color: var(--text);">Cadastrar Novo Usuário</h2>
      <form id="user-form">
          <div class="mb-4">
            <label class="block font-semibold mb-1" style="color: var(--text);">Nome completo</label>
            <input type="text" id="nome" name="nome" class="w-full px-3 py-2 rounded-lg" 
                   style="border: 1px solid var(--border); background: var(--card-bg); color: var(--text);" required>
          </div>
          <div class="mb-4">
            <label class="block font-semibold mb-1" style="color: var(--text);">Email</label>
            <input type="email" id="email" name="email" class="w-full px-3 py-2 rounded-lg"
                   style="border: 1px solid var(--border); background: var(--card-bg); color: var(--text);" required>
          </div>
          <div class="mb-4">
            <label class="block font-semibold mb-1" style="color: var(--text);">Senha</label>
            <input type="password" id="senha" name="senha" class="w-full px-3 py-2 rounded-lg"
                   style="border: 1px solid var(--border); background: var(--card-bg); color: var(--text);" required>
          </div>
          <div class="mb-4">
            <label class="block font-semibold mb-1" style="color: var(--text);">Cargo</label>
            <select id="cargo" name="cargo" class="w-full px-3 py-2 rounded-lg"
                    style="border: 1px solid var(--border); background: var(--card-bg); color: var(--text);" required>
              <option value="FUNCIONARIO">Funcionário</option>
              <option value="SUPERVISOR">Supervisor</option>
              <option value="MASTER">Master</option>
            </select>
          </div>
          <div class="mb-4">
            <label class="block font-semibold mb-1" style="color: var(--text);">Departamento</label>
            <input type="text" id="departamento" name="departamento" class="w-full px-3 py-2 rounded-lg"
                   style="border: 1px solid var(--border); background: var(--card-bg); color: var(--text);" required>
          </div>
          <div class="mb-4">
            <label class="block font-semibold mb-1" style="color: var(--text);">Status</label>
            <select id="status" name="status" class="w-full px-3 py-2 rounded-lg"
                    style="border: 1px solid var(--border); background: var(--card-bg); color: var(--text);" required>
              <option value="ATIVO">Ativo</option>
              <option value="INATIVO">Inativo</option>
              <option value="PENDENTE">Pendente</option>
            </select>
          </div>
        <div class="flex justify-end">
          <button type="submit" class="px-4 py-2 rounded-lg transition" 
                  style="background: var(--color-primary-500); color: white;">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Cards de Estatísticas -->
  <div class="p-5 text-center rounded-xl shadow-md" style="background: var(--card-bg); border: 1px solid var(--border);">
    <div class="text-2xl font-bold mb-1" style="color: var(--color-primary-500);">5</div>
    <div class="text-sm" style="color: var(--text-muted);">Supervisores</div>
    <div class="text-xs mt-1" style="color: var(--text-muted);">12% do total</div>
  </div>
  
  <div class="p-5 text-center rounded-xl shadow-md" style="background: var(--card-bg); border: 1px solid var(--border);">
    <div class="text-2xl font-bold mb-1" style="color: #b45309;">3</div>
    <div class="text-sm" style="color: var(--text-muted);">Pendentes</div>
    <div class="text-xs mt-1 flex items-center justify-center" style="color: #dc2626;">
      <i class="fas fa-clock mr-1"></i> Aguardando aprovação
    </div>
  </div>
</div>

<!-- Tabela de Usuários -->
<div class="p-6 mb-8 rounded-xl shadow-md" style="background: var(--card-bg); border: 1px solid var(--border);">
  <div class="overflow-x-auto">
    <table class="w-full">
      <thead>
        <tr style="border-bottom: 1px solid var(--border);">
          <th class="pb-3 text-left">
            <label class="flex items-center">
              <input type="checkbox" class="rounded" style="color: var(--color-primary-500);">
              <span class="ml-2" style="color: var(--text);">Usuário</span>
            </label>
          </th>
          <th class="pb-3 text-left" style="color: var(--text);">Cargo</th>
          <th class="pb-3 text-left" style="color: var(--text);">Departamento</th>
          <th class="pb-3 text-left" style="color: var(--text);">Status</th>
          <th class="pb-3 text-left" style="color: var(--text);">Último Acesso</th>
          <th class="pb-3 text-right" style="color: var(--text);">Ações</th>
        </tr>
      </thead>
      <tbody class="divide-y" style="border-color: var(--border);">
        <tr>
          <td class="py-4">
            <label class="flex items-center">
              <input type="checkbox" class="rounded" style="color: var(--color-primary-500);">
              <div class="ml-3">
                <div class="font-medium" style="color: var(--text);">Carla Rodrigues</div>
                <div class="text-sm" style="color: var(--text-muted);">carla.rodrigues@empresa.com</div>
              </div>
            </label>
          </td>
          <td class="py-4">
            <span class="px-2 py-1 rounded-full text-xs" 
                  style="background: rgba(59, 130, 246, 0.2); color: #1d4ed8;">FUNCIONARIO</span>
          </td>
          <td class="py-4" style="color: var(--text);">Qualidade</td>
          <td class="py-4">
            <span class="px-2 py-1 rounded-full text-xs" 
                  style="background: rgba(245, 158, 11, 0.2); color: #b45309;">Pendente</span>
          </td>
          <td class="py-4" style="color: var(--text);">Não acessou</td>
          <td class="py-4 text-right">
            <div class="flex justify-end space-x-2">
              <button class="transition" style="color: var(--color-primary-500);" title="Editar">
                <i class="fas fa-edit"></i>
              </button>
              <button class="transition" style="color: #16a34a;" title="Ativar">
                <i class="fas fa-user-check"></i>
              </button>
              <button class="transition" style="color: #dc2626;" title="Excluir">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <!-- Paginação e Controles -->
  <div class="mt-6 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
    <div class="text-sm" style="color: var(--text-muted);">Mostrando 5 de 42 usuários</div>
    
    <div class="flex items-center space-x-4">
      <div class="flex items-center space-x-2">
        <span class="text-sm" style="color: var(--text-muted);">Ações em massa:</span>
        <select class="text-sm px-2 py-1 rounded-md"
                style="border: 1px solid var(--border); background: var(--card-bg); color: var(--text);">
          <option>Selecionar ação</option>
          <option>Ativar usuários</option>
          <option>Desativar usuários</option>
          <option>Excluir usuários</option>
          <option>Enviar email</option>
        </select>
        <button class="text-sm px-3 py-1 rounded-md transition" 
                style="background: var(--card-bg); border: 1px solid var(--border); color: var(--text);">
          Aplicar
        </button>
      </div>
      
      <div class="flex space-x-2">
        <button class="px-3 py-1 rounded border transition" 
                style="border-color: var(--border); color: var(--text);">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="px-3 py-1 rounded transition" 
                style="background: var(--color-primary-500); color: white;">1</button>
        <button class="px-3 py-1 rounded border transition" 
                style="border-color: var(--border); color: var(--text);">2</button>
        <button class="px-3 py-1 rounded border transition" 
                style="border-color: var(--border); color: var(--text);">3</button>
        <button class="px-3 py-1 rounded border transition" 
                style="border-color: var(--border); color: var(--text);">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Gráficos e Estatísticas -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
  <div class="p-6 rounded-xl shadow-md" style="background: var(--card-bg); border: 1px solid var(--border);">
    <h3 class="text-lg font-semibold mb-4" style="color: var(--text);">Distribuição por Perfil</h3>
    <div class="flex items-center justify-center">
      <div class="relative w-40 h-40">
        <!-- Gráfico de pizza -->
        <div class="absolute inset-0 rounded-full border-8" style="border-color: var(--color-primary-500); clip-path: polygon(50% 50%, 50% 0, 100% 0, 100% 100%, 50% 100%);"></div>
        <div class="absolute inset-0 rounded-full border-8" style="border-color: #8b5cf6; clip-path: polygon(50% 50%, 100% 0, 100% 100%, 0 100%, 0 50%);"></div>
        <div class="absolute inset-0 rounded-full border-8" style="border-color: var(--border); clip-path: polygon(50% 50%, 0 50%, 0 0, 100% 0, 100% 50%);"></div>
        <div class="absolute inset-0 flex items-center justify-center">
          <div class="text-center">
            <div class="font-bold" style="color: var(--text);">42</div>
            <div class="text-xs" style="color: var(--text-muted);">Total</div>
          </div>
        </div>
      </div>
    </div>
    <div class="mt-6 space-y-2">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-3 h-3 rounded-full mr-2" style="background: var(--color-primary-500);"></div>
          <span style="color: var(--text);">Governantes</span>
        </div>
        <span class="font-semibold" style="color: var(--text);">2 <span class="text-sm" style="color: var(--text-muted);">(5%)</span></span>
      </div>
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-3 h-3 rounded-full mr-2" style="background: #8b5cf6;"></div>
          <span style="color: var(--text);">Supervisores</span>
        </div>
        <span class="font-semibold" style="color: var(--text);">5 <span class="text-sm" style="color: var(--text-muted);">(12%)</span></span>
      </div>
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-3 h-3 rounded-full mr-2" style="background: var(--border);"></div>
          <span style="color: var(--text);">Funcionários</span>
        </div>
        <span class="font-semibold" style="color: var(--text);">35 <span class="text-sm" style="color: var(--text-muted);">(83%)</span></span>
      </div>
    </div>
  </div>
  
  <div class="p-6 rounded-xl shadow-md" style="background: var(--card-bg); border: 1px solid var(--border);">
    <h3 class="text-lg font-semibold mb-4" style="color: var(--text);">Distribuição por Departamento</h3>
    <div class="space-y-4">
      <div>
        <div class="flex justify-between mb-1">
          <span class="text-sm" style="color: var(--text);">Operações</span>
          <span class="text-sm font-medium" style="color: var(--text);">18</span>
        </div>
        <div class="w-full rounded-full" style="background: var(--border); height: 8px;">
          <div class="rounded-full h-full" style="background: var(--color-primary-500); width: 43%"></div>
        </div>
      </div>
      
      <div>
        <div class="flex justify-between mb-1">
          <span class="text-sm" style="color: var(--text);">Qualidade</span>
          <span class="text-sm font-medium" style="color: var(--text);">12</span>
        </div>
        <div class="w-full rounded-full" style="background: var(--border); height: 8px;">
          <div class="rounded-full h-full" style="background: #16a34a; width: 29%"></div>
        </div>
      </div>
      
      <div>
        <div class="flex justify-between mb-1">
          <span class="text-sm" style="color: var(--text);">Meio Ambiente</span>
          <span class="text-sm font-medium" style="color: var(--text);">7</span>
        </div>
        <div class="w-full rounded-full" style="background: var(--border); height: 8px;">
          <div class="rounded-full h-full" style="background: #8b5cf6; width: 17%"></div>
        </div>
      </div>
      
      <div>
        <div class="flex justify-between mb-1">
          <span class="text-sm" style="color: var(--text);">Administração</span>
          <span class="text-sm font-medium" style="color: var(--text);">5</span>
        </div>
        <div class="w-full rounded-full" style="background: var(--border); height: 8px;">
          <div class="rounded-full h-full" style="background: #d97706; width: 11%"></div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Controles do modal de usuário
  const userModal = document.getElementById('user-modal');
  const closeUserModal = document.getElementById('close-user-modal');
  const addUserBtn = document.getElementById('add-user-btn');
  
  if (addUserBtn && userModal) {
    addUserBtn.addEventListener('click', function() {
      userModal.classList.remove('hidden');
    });
  }
  
  if (closeUserModal && userModal) {
    closeUserModal.addEventListener('click', function() {
      userModal.classList.add('hidden');
    });
  }
  
  if (userModal) {
    userModal.addEventListener('click', function(e) {
      if (e.target === userModal) {
        userModal.classList.add('hidden');
      }
    });
  }
});
</script>
{% endblock %}